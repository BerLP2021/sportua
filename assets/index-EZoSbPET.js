var u=Object.defineProperty;var h=(o,e,t)=>e in o?u(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var i=(o,e,t)=>h(o,typeof e!="symbol"?e+"":e,t);function b(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}})();class c{toggleBodyClass(e,t){document.body.classList.toggle(e,t)}}class m extends c{constructor(t,r,s){super();i(this,"dialog");i(this,"triggerOpenBtn");i(this,"triggerCloseBtn");if(this.dialog=document.querySelector(t),this.triggerOpenBtn=document.querySelector(r),this.triggerCloseBtn=document.querySelector(s),!this.dialog)throw new Error("Dialog not found")}init(){var t,r,s;(t=this.triggerOpenBtn)==null||t.addEventListener("click",()=>this.open()),(r=this.triggerCloseBtn)==null||r.addEventListener("click",()=>this.close()),(s=this.dialog)==null||s.addEventListener("close",()=>this.toggleBodyClass("menu-open",!1)),document.addEventListener("click",n=>this.handleClickOutsideDialog(n))}open(){var t;this.toggleBodyClass("menu-open",!0),(t=this.dialog)==null||t.showModal()}close(){var t;(t=this.dialog)==null||t.close()}handleClickOutsideDialog(t){var s;t.target.contains(this.dialog)&&((s=this.dialog)==null||s.close())}}class p extends c{constructor(t,r){super();i(this,"popover");i(this,"triggerCloseBtn");if(this.popover=document.querySelector(t),this.triggerCloseBtn=document.querySelector(r),!this.popover)throw new Error("Popover not found")}init(){var t,r;(t=this.popover)==null||t.addEventListener("beforetoggle",s=>{s instanceof ToggleEvent&&this.toggleBodyClass("menu-open",s.newState==="open")}),(r=this.triggerCloseBtn)==null||r.addEventListener("click",()=>this.close())}close(){var t;(t=this.popover)==null||t.hidePopover()}}class g{constructor(e,t){i(this,"trigger");i(this,"form");i(this,"input");i(this,"removeListeners",null);const r=document.querySelector(e),s=document.querySelector(t);if(!r||!s)throw new Error("Trigger or form not found");this.trigger=r,this.form=s,this.input=s.querySelector('input[type="search"]'),this.init()}init(){this.trigger.addEventListener("click",()=>this.toggleForm()),this.form.addEventListener("submit",e=>{e.preventDefault(),this.toggleForm()})}toggleForm(){this.form.hasAttribute("inert")?this.openForm():this.closeForm()}openForm(){this.form.removeAttribute("inert"),this.form.classList.add("active"),this.disableTabbing();let e=!1;const t=()=>{var r;e||((r=this.input)==null||r.focus(),this.restoreTabbing(),e=!0)};this.form.addEventListener("transitionend",t,{once:!0}),setTimeout(t,300),this.removeListeners=this.addCloseListeners()}closeForm(){var e;this.form.setAttribute("inert","true"),this.form.classList.remove("active"),this.restoreTabbing(),(e=this.removeListeners)==null||e.call(this)}disableTabbing(){this.form.querySelectorAll("button, input, [tabindex]").forEach(t=>{t.setAttribute("tabindex","-1")})}restoreTabbing(){this.form.querySelectorAll("button, input, [tabindex]").forEach(t=>{t.hasAttribute("tabindex")&&t.getAttribute("tabindex")==="-1"?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")})}addCloseListeners(){const e=r=>{this.form.contains(r.target)||this.closeForm()},t=r=>{r.key==="Escape"&&this.closeForm()};return document.documentElement.addEventListener("click",e,!0),document.documentElement.addEventListener("keydown",t,!0),()=>{document.documentElement.removeEventListener("click",e,!0),document.documentElement.removeEventListener("keydown",t,!0)}}}const f='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" width="200" height="200" style="shape-rendering: auto; display: block; background: transparent;" xmlns:xlink="http://www.w3.org/1999/xlink"><g><circle stroke-dasharray="164.93361431346415 56.97787143782138" r="35" stroke-width="10" stroke="#fadb00" fill="none" cy="50" cx="50">\n  <animateTransform keyTimes="0;1" values="0 50 50;360 50 50" dur="1s" repeatCount="indefinite" type="rotate" attributeName="transform"></animateTransform>\n</circle><g></g></g><!-- [ldio] generated by https://loading.io --></svg>';class d{constructor(e,t,r){i(this,"apiUrl");i(this,"query");i(this,"container");this.apiUrl=e,this.query=r;const s=document.querySelector(t);if(!s)throw new Error('Контейнер "'.concat(t,'" не найден'));this.container=s}async init(){const e=Array.from(this.container.querySelectorAll("table")).findIndex(t=>t.dataset.tableType===this.query)!==-1;this.hideActiveTable(),e||this.showLoader();try{if(e)this.showActiveTable();else{const t=await this.fetchData(),r=this.groupBy(t,"group");this.renderTables(r)}}catch(t){this.showError(t)}finally{this.hideLoader()}}async fetchData(){if(!this.query)return new Promise(t=>t([]));const e=await fetch(this.apiUrl);if(!e.ok)throw new Error("Ошибка при загрузке данных: ".concat(e.status));return await new Promise(t=>setTimeout(t,500)),await e.json()}groupBy(e,t){return e.reduce((r,s)=>{const n=String(s[t]);return r[n]||(r[n]=[]),r[n].push(s),r},{})}renderTables(e){Object.entries(e).forEach(([t,r])=>{const s=document.createElement("table");s.dataset.tableType=this.query,s.innerHTML=this.getTableHead(t)+this.getTableBody(r),this.container.appendChild(s)})}showActiveTable(){this.container.querySelectorAll("table").forEach(e=>{e.dataset.tableType!==this.query?e.style.display!=="none"&&(e.style.display="none"):e.style.display=""})}hideActiveTable(){this.container.querySelectorAll("table").forEach(e=>{e.style.display="none"})}getTableHead(e){return'\n      <thead>\n        <tr class="tournament__results-table-row tournament__results-table-row_head">\n          <th class="tournament__row-group">Группа '.concat(e.toUpperCase(),'</th>\n          <th class="tournament__row-games"><span class="mobile">И</span><span class="desktop">Игры</span></th>\n          <th class="tournament__row-wins">В</th>\n          <th class="tournament__row-draws">Н</th>\n          <th class="tournament__row-losses">П</th>\n          <th class="tournament__row-scored-conceded">З - П</th>\n          <th class="tournament__row-last-matches">Форма</th>\n          <th class="tournament__row-points"><span class="mobile">О</span><span class="desktop">Очки</span></th>\n        </tr>\n      </thead>\n    ')}getQualificationLabel(e){switch(e){case 0:return["tournament__row-position_blue","Чемпионы Лига чемпионов УЕФА"];case 1:return["tournament__row-position_light-blue","Лига чемпионов УЕФА"];case 2:return["tournament__row-position_yellow","Лига Европы УЕФА"];case 3:return["tournament__row-position_orange","Понижение"];default:return["tournament__row-position_orange","Понижение"]}}getTableBody(e){const t=[...e].sort((r,s)=>s.points-r.points);return"\n      <tbody>\n        ".concat(t.map((r,s)=>'\n            <tr class="tournament__results-table-row tournament__results-table-row_body">\n              <td class="tournament__row-position '.concat(this.getQualificationLabel(s)[0],'">').concat(s+1,' <span class="tournament__row-tooltip">').concat(this.getQualificationLabel(s)[1],'</span></td>\n              <td class="tournament__row-club-logo"><img src="').concat(r.logo,'" onerror="this.onerror=null; this.src=\'src/assets/icons/stub-fc.png\';"/></td>\n              <td class="tournament__row-club-name"><a href="#">').concat(r.name," ________").concat(this.query,'</a></td>\n              <td class="tournament__row-games">').concat(r.games,'</td>\n              <td class="tournament__row-wins">').concat(r.wins,'</td>\n              <td class="tournament__row-draws">').concat(r.draws,'</td>\n              <td class="tournament__row-losses">').concat(r.loses,'</td>\n              <td class="tournament__row-scored-conceded">').concat(r.scored," - ").concat(r.conceded,'</td>\n              <td class="tournament__row-last-matches">').concat(this.renderLastMatches(r.form),'</td>\n              <td class="tournament__row-points">').concat(r.points,"</td>\n            </tr>\n          ")).join(""),"\n      </tbody>\n    ")}renderLastMatches(e){return'\n      <div class="tournament__last-matches-wrapper">\n        '.concat(e.map(t=>{let r="",s="";switch(t){case"W":r="tournament__last-match_win",s="win";break;case"D":r="tournament__last-match_draw",s="draw";break;case"L":r="tournament__last-match_loss",s="loss";break}return'\n              <span class="tournament__last-match '.concat(r,'">\n                <svg width="18" height="18">\n                  <use href="src/assets/icons/sprite.svg#').concat(s,'"></use>\n                </svg>\n              </span>\n            ')}).join(""),"\n      </div>\n    ")}showLoader(){this.container.insertAdjacentHTML("afterbegin",'<div class="spinner">'.concat(f,"</div>"))}hideLoader(){const e=this.container.querySelector(".spinner");e&&e.remove()}showError(e){this.container.innerHTML='<div class="error">Ошибка: '.concat(e.message,"</div>")}}document.addEventListener("mouseup",function(o){const e=o.target.closest("button");e==null||e.blur()});document.querySelectorAll("button").forEach(o=>{o.addEventListener("keydown",()=>{o.blur()})});new g(".header__search-btn",".header__search-form");new p("#burgerMenu",".close-burger-menu-btn").init();new m("#signInDialog",".open-user-menu-btn",".close-user-menu-btn").init();const a=document.querySelector(".tournament__results-filters");new d("https://63ee0ec0388920150dd83e3c.mockapi.io/teams",".tournament__results-table","total").init();a==null||a.addEventListener("click",o=>{const e=o.target;e.tagName==="BUTTON"&&e.dataset.type&&(a==null||a.querySelectorAll("button").forEach(t=>{t.classList.remove("tournament__results-filter_active"),t.disabled=!1,t.setAttribute("aria-selected","false"),t.setAttribute("aria-disabled","false")}),e.classList.add("tournament__results-filter_active"),e.disabled=!0,e.setAttribute("aria-selected","true"),e.setAttribute("aria-disabled","true"),new d("https://63ee0ec0388920150dd83e3c.mockapi.io/teams",".tournament__results-table",e.dataset.type).init(),console.log("It fake fetch for ".concat(e.dataset.type,".\n\nBut data still fetched from https://63ee0ec0388920150dd83e3c.mockapi.io/teams")))});export{b as __vite_legacy_guard};
